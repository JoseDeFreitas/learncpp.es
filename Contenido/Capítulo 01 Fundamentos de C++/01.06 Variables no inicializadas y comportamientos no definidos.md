# 01.06 Variables no inicializadas y comportamientos no definidos

<details>
    <summary>Información del archivo</summary>

| Autor en inglés | Traductor al español | Fecha de creación | Última modificación |
| --------------- | -------------------- | ----------------- | ------------------- |
| Alex            | José De Freitas      | 01/02/2019        | 22/11/2020          |

</details>

En esta lección te enseñaremos sobre std::cout, la función que usamos en nuestro programa
hola mundo para imprimir el texto "*¡Hola, mundo!*" a la consola. También te enseñaremos a
tomar el input del usuario, haciendo que nuestros programas sean más interactivos.

#### **Índice**

1. [Variables no inicializadas](#variables-no-inicializadas)
2. [Comportamiento indefinido](#comportamiento-indefinido)
3. [Prueba](#prueba)

## Variables no inicializadas

A diferencia de otros lenguajes de programación, C/C++ no suele inicializar automáticamente
la mayoría de las variables a un valor específico (como cero). Por lo tanto, cuando el
compilador asigna una variable a una dirección en la memoria, el valor por defecta de esa
variable es cualquier valor que ya esté en esa dirección de memoria. Las variables que no
tienen un valor definido (usualmente por inicialización o asignación) se llaman **variables no inicializadas**.

> **Nota del autor**
>
> La mayoría de los lectores esperarán que "inicializada" y "no inicializada" sean antónimos,
> pero, ¡no es así en realidad! Al inicializar estamos dándole al objeto un valor inicial
> cuando lo definimos. Un objeto que no está inicializado quiere decir que no se le ha dado
> un valor (de cualquier manera, incluida la asignación). Por tal motivo, un objeto que no
> está inicializado pero al que se le ha asignado un valor pasa a ser *inicializado* (porque
> tiene ahora un valor conocido).
>
> Para recapitular:
> - Inicialización = Se le da un valor conocido al objeto cuando es definido.
> - Asignación = Se le da un valor conocido al objeto después de ser definido.
> - No inicializado = Aún no se le ha dado un valor conocido al objeto.

> **Información extra**
>
> Esta falta de inicialización es una optimización del rendimiento tomada del lenguaje C,
> cuando las computadoras eran más lentas. Imagina que necesitas leer 100.000 valores de un
> archivo. En ese caso estarías creando 100.000 variables para luego asignarle cada valor a
> cada una de ellas.
>
> Si C++ inicializace todas esas variables con los valores por defecto a la hora de ser
> creadas se estarían ejecutando 100.000 inicializaciones (lo cual sería lento) y de poco
> beneficio (ya que estarías sobrescribiendo los valores de todas maneras).
>
> Por ahora debes inicializar tus varaibles siempre porque el costo de hacerlo es minúsculo
> comparado con el beneficio. Cuando tengas experiencia con el lenguaje encontrás casos en los
> que omitirás la inicialización de variables por cuestiones de optimización. Aún así, esto
> siempre debería ser selectivo e intencionado.

Usar los valores de variables no inicializadas puede devolver resultados inesperados.
Conside el siguiente programa:
```cpp
#include <iostream>
 
int main()
{
    // define una variable de tipo entero llamada x
    int x; // esta variable no está inicializada porque no le hemos asignado un valor
    
    // imprime el valor de x en la pantalla
    std::cout << x; // quién sabe qué obtendremos, ya que x no está inicializada
 
    return 0;
}
```

En este caso la computadora le asignará a *x* algún espacio sin usar en la memoria. Luego
enviará el valor que se encuentra en esa dirección de memoria a *std::cout*, el cual imprimirá
el valor (interpretado como un entero). Perom ¿qué valor imprimirá? La respuesta es:
"¡Quién sabe!", y tal vez cambie esta respuesta cada vez que ejecutes el programa. Cuando el
autor ejecutó este programa en Visual Studio, *std::cout* imprimió el valor `7177728` una vez
y `5277592` la siguiente. Puedes compilar y ejecutar el programa por ti mismo (no explotará
tu computadora).

> **Información extra**
>
> Algunos compiladores, como el de Visual Studio, *inicializarán* el contenido de la memoria
> a algún valor predeterminado si estás usando la configuración de depuración. Esto no
> ocurrirá si estás usando una configuración de lanzamiento. Si quieres ejecutar el programa
> de arriba por ti mismo asegúrate de que estás usando la *configuración de lanzamiento*
> (lee la [lección 00.09](https://github.com/JoseDeFreitas/learncpp.es/blob/main/Contenido/Cap%C3%ADtulo%2000%20Introducci%C3%B3n%20-%20Empezando/00.09%20Configurando%20tu%20compilador%20-%20Configuraciones%20de%20compilaci%C3%B3n.md) para recordar cómo hacer eso).
> Por ejemplo, si ejecutar el programa de arriba usando la configuración de depuración en
> Visual Studio, el programa imprimirá constantemente el valor `-858993460` porque ese es el
> valor (interpretado como un entero) que utiliza Visual Studio en la memoria al inicializar
> si estás usando la configuración de depuración.

La mayoría de los compiladores modernos intentarás detectar si se está usando una variable
sin tener un valor asignado. Si tu compilador puede detectar esto es probable que devuelva
un error de compilación. Por ejemplo, al compilar el programa de arriba en Visual Studio
nos devuelve la siguiente advertencia:
```
c:\VCprojects\test\test.cpp(11) : warning C4700: uninitialized local variable 'x' used
```

Si tu compilador no te deja compilar y ejecutar el programa por esta razón, hay una solución
disponible para solucionar este problema:
```cpp
#include <iostream>
 
void doNothing(int&) // No te preocupes por esto por ahora; esta declaración la estamos usando para engañar al compilador para que crear que estamos usando la variable x
{
}
 
int main()
{
    // define una variable de tipo entero llamada x
    int x; // esta variable no está inicializada porque no le hemos asignado un valor
 
    doNothing(x); // hacer creer al compilador que estamos asignando un valor a esta variable
 
    // imprime el valor de x en la pantalla (quién sabe qué obtendremos, ya que x no está inicializada)
    std::cout << x;
 
    return 0;
}
```

El utilizar variables no inicializadas es un error común de los programadores principiantes y,
desafortunadamente, también puede ser uno de los más complejos para depurar (porque puede
que el programa se ejecute satisfactoriamente a pesar de que un valor no inicializado está
asignado a un espacio en memoria que tenía un valor razonable en él, como 0).

Esta es la razón principal por la que la mejor práctica es "siempre inicializar tus variables".

## Comportamiento indefinido

Usar un valor de una variable no inicializada es nuestro primer ejemplo de un comportamiento
indefinido. Un **comportamiento indefinido** (abreviado en inglés como "UB") es el resultado
de ejecutar código que tiene un comportamiento no definido por el lenguaje C++. En este
caso, el lenguaje C++ no tiene ninguna regla que determine qué pasa si usas un valor de una
variable que no tiene un valor conocido. Por consiguiente, si haces esto tu código tiene un
comportamiento indefinido.

El código que tiene un comportamiento indefinido presenta las siguientes características:
- El programa produce resultados inesperados cuando es ejecutado.
- El programa produce el mismo resultado incorrecto cada vez que es ejecutado.
- El comportamiento del programa no es consistente (a veces produce el resultado correcto y a veces el incorrecto).
- Parece que el programa está funcionando pero produce resultados incorrectos en alguna parte posterior del programa.
- El programa falla, ya sea inmediatamente o después de un tiempo.
- El programa funciona en algunos compiladores pero no en otros.
- El programa funciona hasta que cambias una porción de código que no tiene relación a la porción que produce la falla.

O, puede que tu código tenga el comportamiento correcto. La naturaleza del comportamiento
indefinido es que nunca estás 100% seguro de qué devolverá el programa cada vez y si el
comportamiento cambiará si haces algún cambio en el código.

C++ contiene muchos casos que pueden resultar en un comportamiento inesperado si no tienes
cautela. Te enseñaremos más sobre esto en futuras lecciones. Toma nota de dónde pueden
encontrarse estos casos y cómo evitarlos.

> **Regla**
>
> Asegúrate de evitar todas las situaciones que resulten en un comportamiento indefinido,
> como usar una variable no inicializada.

> **Nota del autor**
>
> Un comentario muy común que hacen los programadores principiantes es "Según tu no podía usar
> X, pero lo hice y mi programa se ejecutó correctamente. ¿Por qué?"
>
> Hay dos respuestas comunes. La más común es que tu programa realmente tiene un
> comportamiento indefinido, solo que éste está devolviendo el valor que realmente esperabas,
> pero solo por el momento. Puede que el día siguiente (o si usas un compilador o una
> computadora diferente) no funcione.
>
> Como alternativa a veces los autores del compilador se toman la libertad con los
> requisitos del lenguaje cuando esos requisitos son restrictivos. Por ejemplo, puede que
> según el estándar "debes hacer X antes que Y", pero el autor del compilador puede considerar
> esto innecesario y hacer que Y funcione a pesar de que no hayas hecho X anteriormente. Esto
> no debería afectar la operación de un programa escrito correctamente pero puede causar que
> los programas escritos de manera errónea funcionen igualmente. La segunda respuesta es que
> ¡tu compilador no está siguiendo el estándar del lenguaje! Esto es algo que puede pasar.
> Puedes evitar este tipo de situaciones si te aseguras de haber desactivado las extensiones
> del compilador, como te enseñamos en la [lección 00.10](/Contenido/Cap%C3%ADtulo%2000%20Introducci%C3%B3n%20-%20Empezando/00.10%20Configurando%20tu%20compilador%20-%20Extensiones%20del%20compilador.md).

## Prueba

**Pregunta 1**

¿Qué es una variable no inicializada? ¿Por qué deberías evitar usar una?

<details>
    <summary>Mostrar solución</summary>
    Una variable no inicializada es una variable a la que aún no se le ha asignado un valor
    (generalmente a través de la inicialización o la asignación). Usar el valor almacenado en
    una variable no inicializada puede resultar en un comportamiento indefinido.
</details>

**Pregunta 2**

¿Qué es el comportamiento indefinido y qué puede ocurrir si escribes código con comportamiento
indefinido?

<details>
    <summary>Mostrar solución</summary>
    El comportamiento indefinido es el resultado de ejecutar código que tiene un comportamiento que no está determinado por el lenguaje. El resultado puede ser cualquiera, incluyendo algo que está correcto.
</details>

---

**[Lección anterior](/Contenido/Cap%C3%ADtulo%2001%20Fundamentos%20de%20C%2B%2B/01.05%20Introducci%C3%B3n%20a%20iostream%20-%20cout%2C%20cin%20y%20endl.md)** - **[Contenido](https://github.com/JoseDeFreitas/learncpp.es#contenido)** - **[Lección siguiente](/Contenido/Cap%C3%ADtulo%2001%20Fundamentos%20de%20C%2B%2B/01.07%20Palabras%20reservadas%20e%20identificadores.md)**